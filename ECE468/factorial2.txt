;IR code
;LABEL factorial 
;LINK
;STOREI 1 $T1
;NE $P1 $T1 label1
;STOREI 1 $T2
;STOREI $T2 $R
;RET
;JUMP label2 
;LABEL label1 
;STOREI 1 $T3
;SUBI $P1 $T3 $T4
;PUSH
;PUSH $T4 
;JSR factorial 
;POP
;POP $T5 
;STOREI $T5 $L2
;MULTI $L2 $P1 $T6
;STOREI $T6 $L1
;LABEL label2 
;STOREI $L1 $R
;RET

;LABEL main 
;LINK
;WRITES input 
;READI $L1 
;STOREI 1 $T1
;NE $L1 $T1 label3
;STOREI 1 $T2
;STOREI $T2 $L2
;JUMP label4 
;LABEL label3 
;STOREI 1 $T3
;LE $L1 $T3 label5
;PUSH
;PUSH $L1 
;JSR factorial 
;POP
;POP $T4 
;STOREI $T4 $L2
;JUMP label6 
;LABEL label5 
;STOREI 0 $T5
;STOREI $T5 $L2
;LABEL label6 
;LABEL label4 
;WRITEI $L2 
;WRITES eol 
;STOREI 0 $T6
;STOREI $T6 $R
;RET

;tiny code
str input "Please enter an integer number: " 
str eol "\n" 
push 
push r0 
push r1 
push r2 
push r3 
jsr main 
sys halt 
label factorial 
link 3 
move 1 r0 
cmpi $P1 r0 
jne label1 
move 1 r1 
move r1 $R 
cmpr none r1 
cmpr none 
jmp label2 
label label1 
move 1 r2 
move $6 r3 
subi $-5 r3 
cmpr none r3 
cmpr none 
cmpr none r3 
cmpr $T4 
cmpr none r3 
cmpr factorial 
cmpr none r3 
cmpr none 
cmpr none r3 
cmpr $T5 
move r4 $L2 
move $-2 r5 
muli $6 r5 
move r5 $L1 
label label2 
move r5 $R 
cmpr none r5 
cmpr none 
cmpr none r5 
cmpr none 
label main 
link 3 
sys writes input 
sys readi $L1 
move 1 r6 
cmpi $L1 r6 
jne label3 
move 1 r7 
move r7 $L2 
jmp label4 
label label3 
move 1 r8 
cmpi $L1 r8 
jle label5 
cmpr none r8 
cmpr none 
cmpr none r8 
cmpr $L1 
cmpr none r8 
cmpr factorial 
cmpr none r8 
cmpr none 
cmpr none r8 
cmpr $T4 
move r3 $L2 
jmp label6 
label label5 
move 0 r9 
move r9 $L2 
label label6 
label label4 
sys writei $L2 
sys writes eol 
move 0 r10 
move r10 $R 
cmpr none r10 
cmpr none 
cmpr none r10 
cmpr none 
