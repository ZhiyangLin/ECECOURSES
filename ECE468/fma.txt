;IR code
;LABEL add 
liveOut:
$P1 $P2 
;LINK
liveOut:
$P1 $P2 
;ADDF $P1 $P2 $T1
liveOut:
$T1 
;STOREF $T1 $L1
liveOut:
$L1 
;STOREF $L1 $R
liveOut:

;RET

liveOut:

;LABEL multiply 
liveOut:
$P1 $P2 
;LINK
liveOut:
$P1 $P2 
;MULTF $P1 $P2 $T1
liveOut:
$T1 
;STOREF $T1 $L1
liveOut:
$L1 
;STOREF $L1 $R
liveOut:

;RET

liveOut:

;LABEL main 
liveOut:
intro first second third star plus equal eol 
;LINK
liveOut:
intro first second third star plus equal eol 
;WRITES intro 
liveOut:
first second third star plus equal eol 
;WRITES first 
liveOut:
second third star plus equal eol 
;READF $L1 
liveOut:
second third $L1 star plus equal eol 
;WRITES second 
liveOut:
third $L1 star plus equal eol 
;READF $L2 
liveOut:
third $L1 $L2 star plus equal eol 
;WRITES third 
liveOut:
$L1 $L2 star plus equal eol 
;READF $L3 
liveOut:
$L1 $L2 $L3 star plus equal eol 
;PUSH
liveOut:
$L1 $L2 $L3 star plus equal eol 
;PUSH $L1 
liveOut:
$L2 $L3 $L1 star plus equal eol 
;PUSH $L2 
liveOut:
$L3 $L1 star $L2 plus equal eol 
;JSR multiply 
liveOut:
$L3 $L1 star $L2 plus equal eol 
;POP
liveOut:
$L3 $L1 star $L2 plus equal eol 
;POP
liveOut:
$L3 $L1 star $L2 plus equal eol 
;POP $T1 
liveOut:
$T1 $L3 $L1 star $L2 plus equal eol 
;STOREF $T1 $L5
liveOut:
$L5 $L3 $L1 star $L2 plus equal eol 
;PUSH
liveOut:
$L5 $L3 $L1 star $L2 plus equal eol 
;PUSH $L5 
liveOut:
$L3 $L1 star $L2 plus equal eol 
;PUSH $L3 
liveOut:
$L1 star $L2 plus $L3 equal eol 
;JSR add 
liveOut:
$L1 star $L2 plus $L3 equal eol 
;POP
liveOut:
$L1 star $L2 plus $L3 equal eol 
;POP
liveOut:
$L1 star $L2 plus $L3 equal eol 
;POP $T2 
liveOut:
$T2 $L1 star $L2 plus $L3 equal eol 
;STOREF $T2 $L4
liveOut:
$L1 star $L2 plus $L3 equal $L4 eol 
;WRITEF $L1 
liveOut:
star $L2 plus $L3 equal $L4 eol 
;WRITES star 
liveOut:
$L2 plus $L3 equal $L4 eol 
;WRITEF $L2 
liveOut:
plus $L3 equal $L4 eol 
;WRITES plus 
liveOut:
$L3 equal $L4 eol 
;WRITEF $L3 
liveOut:
equal $L4 eol 
;WRITES equal 
liveOut:
$L4 eol 
;WRITEF $L4 
liveOut:
eol 
;WRITES eol 
liveOut:

;STOREI 0 $T3
liveOut:
$T3 
;STOREI $T3 $R
liveOut:

;RET

liveOut:

;tiny code
str intro "You will be asked for three float numbers\n" 
str first "Please enter the first float number: " 
str second "Please enter the second float number: " 
str third "Please enter the third float number: " 
str eol "\n" 
str star "*" 
str plus "+" 
str equal "=" 
push 
push r0 
push r1 
push r2 
push r3 
jsr main 
sys halt 
label add 
link 1 
move $7 r0 
addr $6 r0 
move r0 $-1 
move $-1 r1 
move r1 $8 
unlnk 
ret 
label multiply 
link 1 
move $7 r2 
mulr $6 r2 
move r2 $-1 
move $-1 r3 
move r3 $8 
unlnk 
ret 
label main 
link 5 
sys writes intro 
sys writes first 
sys readr $-1 
sys writes second 
sys readr $-2 
sys writes third 
sys readr $-3 
push 
push $-1 
push $-2 
push r0 
push r1 
push r2 
push r3 
jsr multiply 
pop r3 
pop r2 
pop r1 
pop r0 
pop 
pop 
pop r4 
move r4 $-5 
push 
push $-5 
push $-3 
push r0 
push r1 
push r2 
push r3 
jsr add 
pop r3 
pop r2 
pop r1 
pop r0 
pop 
pop 
pop r5 
move r5 $-4 
sys writer $-1 
sys writes star 
sys writer $-2 
sys writes plus 
sys writer $-3 
sys writes equal 
sys writer $-4 
sys writes eol 
move 0 r6 
move r6 $6 
unlnk 
ret 
end
